
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ•™å‹™ç”¨ æ•™å®¤äºˆç´„ç®¡ç†</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: center; font-size: 0.9rem; }
    th { background-color: #f0f0f0; }
    select { font-size: 0.9rem; }
    .note-area, .date-area { margin-top: 20px; }
    textarea { width: 100%; height: 60px; font-size: 1rem; }
    input[type="date"] { font-size: 1rem; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 1rem; }
    .saved-message { color: green; margin-top: 10px; }
    .bg-ä½¿ç”¨ä¸å¯ { background-color: #fdd; }
    .bg-éŸ³å‡ºã—ä¸å¯ { background-color: #ffd; }
    .bg-æŠ½é¸ä¸­ { background-color: #ddf; }
    .bg-äºˆç´„æ¸ˆ { background-color: #dfd; }
  </style>
</head>
<body>

<h1>æ•™å‹™ç”¨ï¼šæ•™å®¤äºˆç´„è¨­å®šç”»é¢</h1>

<div class="date-area">
  <label>ğŸ“… è¡¨ç¤ºã‚’é–‹å§‹ã™ã‚‹æ—¥ä»˜ï¼ˆä¾‹ï¼š2025-06-17ï¼‰ï¼š</label>
  <input type="date" id="start-date" />
</div>

<div class="note-area">
  <label>ğŸ“¢ å­¦ç”Ÿã«è¡¨ç¤ºã•ã‚Œã‚‹æ³¨æ„æ–‡ã‚’å…¥åŠ›ï¼š</label>
  <textarea id="admin-note">ä¾‹ï¼šCæ£Ÿå…¨ä½“ã¯6/22ï¼ˆåœŸï¼‰éŸ³å‡ºã—ç¦æ­¢ã§ã™ã€‚</textarea>
</div>

<table id="reservation-table">
  <thead>
    <tr>
      <th>è¬›ç¾©å®¤</th><th>å®šå“¡</th><th>å¸­</th>
      <th id="day0"></th><th id="day1"></th><th id="day2"></th>
      <th id="day3"></th><th id="day4"></th><th id="day5"></th><th id="day6"></th>
    </tr>
  </thead>
  <tbody id="table-body"></tbody>
</table>

<button onclick="saveSettings()">å¤‰æ›´ã‚’ä¿å­˜</button>
<div class="saved-message" id="save-status"></div>

<script>
const rooms = [
  ["C101", 105, "å›ºå®š"], ["C104", 52, "ã‚»ãƒ‘"], ["C105", 68, "ã‚»ãƒ‘"], ["C106", 102, "ã‚»ãƒ‘"],
  ["C202", 156, "å›ºå®š"], ["C203", 73, "å›ºå®š"], ["C204", 44, "ã‚»ãƒ‘"], ["C205", 60, "å›ºå®š"],
  ["C206", 106, "å›ºå®š"], ["C301", 105, "å›ºå®š"], ["C302", 156, "å›ºå®š"], ["C303", 72, "å›ºå®š"],
  ["C304", 51, "ã‚»ãƒ‘"], ["C305", 54, "å›ºå®š"], ["C306", 106, "å›ºå®š"], ["C307", 72, "å›ºå®š"],
  ["C308", 72, "å›ºå®š"], ["C401", 105, "å›ºå®š"], ["C402", 156, "å›ºå®š"], ["C403", 72, "å›ºå®š"],
  ["C404", 53, "ã‚»ãƒ‘"], ["C405", 54, "å›ºå®š"], ["C406", 106, "å›ºå®š"], ["C407", 36, "ã‚»ãƒ‘"],
  ["C408", 36, "ã‚»ãƒ‘"], ["C409", 36, "ã‚»ãƒ‘"], ["è¬›ç¾©å®¤", 309, "å›ºå®š"]
];

function formatDate(date) {
  return date.getMonth()+1 + "/" + date.getDate();
}

function updateHeaders(startDate) {
  const base = new Date(startDate);
  for (let i = 0; i < 7; i++) {
    const d = new Date(base);
    d.setDate(base.getDate() + i);
    document.getElementById("day" + i).textContent = formatDate(d);
  }
}

function generateTable() {
  const tbody = document.getElementById("table-body");
  tbody.innerHTML = "";
  const statusData = JSON.parse(localStorage.getItem("roomStatus") || "{}");
  const startDate = document.getElementById("start-date").value;
  localStorage.setItem("startDate", startDate);

  for (let [room, cap, seat] of rooms) {
    let row = `<tr><td>${room}</td><td>${cap}</td><td>${seat}</td>`;
    for (let day = 0; day < 7; day++) {
      const key = `${room}_${day}`;
      const value = statusData[key] || "ä½¿ç”¨å¯";
      row += `<td class="bg-${value}">
        <select data-room="${room}" data-day="${day}" onchange="updateCellStyle(this)">
          <option value="ä½¿ç”¨å¯"${value==="ä½¿ç”¨å¯"?" selected":""}>ä½¿ç”¨å¯</option>
          <option value="ä½¿ç”¨ä¸å¯"${value==="ä½¿ç”¨ä¸å¯"?" selected":""}>ä½¿ç”¨ä¸å¯</option>
          <option value="éŸ³å‡ºã—ä¸å¯"${value==="éŸ³å‡ºã—ä¸å¯"?" selected":""}>éŸ³å‡ºã—ä¸å¯</option>
          <option value="æŠ½é¸ä¸­"${value==="æŠ½é¸ä¸­"?" selected":""}>æŠ½é¸ä¸­</option>
          <option value="äºˆç´„æ¸ˆ"${value==="äºˆç´„æ¸ˆ"?" selected":""}>äºˆç´„æ¸ˆ</option>
        </select>
      </td>`;
    }
    row += "</tr>";
    tbody.innerHTML += row;
  }

  updateHeaders(startDate);
}

function updateCellStyle(selectElem) {
  const td = selectElem.closest("td");
  td.className = "bg-" + selectElem.value;
}

function saveSettings() {
  const note = document.getElementById("admin-note").value;
  localStorage.setItem("adminNote", note);
  const selects = document.querySelectorAll("select");
  const statusData = {};
  selects.forEach(sel => {
    const key = sel.dataset.room + "_" + sel.dataset.day;
    statusData[key] = sel.value;
  });
  localStorage.setItem("roomStatus", JSON.stringify(statusData));
  document.getElementById("save-status").textContent = "âœ… ä¿å­˜ã—ã¾ã—ãŸï¼ˆå­¦ç”Ÿç”»é¢ã«åæ˜ ã•ã‚Œã¾ã™ï¼‰";
}

window.onload = () => {
  const note = localStorage.getItem("adminNote");
  if (note) document.getElementById("admin-note").value = note;

  const storedDate = localStorage.getItem("startDate");
  const today = new Date().toISOString().slice(0, 10);
  document.getElementById("start-date").value = storedDate || today;

  generateTable();
};

document.getElementById("start-date").addEventListener("change", generateTable);
</script>

</body>
</html>
